<!DOCTYPE html>




<html class="theme-next pisces" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.0.5" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/uploads/apple-touch-icon-next.png?v=6.0.5">


  <link rel="icon" type="image/png" sizes="32x32" href="/uploads/favicon-32x32.png?v=6.0.5">


  <link rel="icon" type="image/png" sizes="16x16" href="/uploads/favicon-16x16.png?v=6.0.5">


  <link rel="mask-icon" href="/uploads/logo.svg?v=6.0.5" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '6.0.5',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  
  <meta name="keywords" content="Android, Life" />


<meta name="description" content="记录学习、生活">
<meta property="og:type" content="website">
<meta property="og:title" content="無名小子的杂货铺">
<meta property="og:url" content="http://whiskeyfei.github.io/page/5/index.html">
<meta property="og:site_name" content="無名小子的杂货铺">
<meta property="og:description" content="记录学习、生活">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="無名小子的杂货铺">
<meta name="twitter:description" content="记录学习、生活">






  <link rel="canonical" href="http://whiskeyfei.github.io/page/5/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>
  <title>無名小子的杂货铺</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> 

<div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">無名小子的杂货铺</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">越努力越幸运</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
          
  <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
</li>

      

      
    </ul>
  

  

  
</nav>


  



 </div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://whiskeyfei.github.io/2015/11/10/android/2015-12-17-android-use-mvp2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="無名">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/face.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="無名小子的杂货铺">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/10/android/2015-12-17-android-use-mvp2/" itemprop="url">Android MVP 项目使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-11-10T19:28:39+09:00">2015-11-10</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Android/" itemprop="url" rel="index"><span itemprop="name">Android</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>前段时间学习 MVP 思想，在原来 <a href="https://github.com/liuling07/SimpleNews" target="_blank" rel="noopener">SimpleNews</a> 的基础上，修改了数据层和 UI 层的逻辑，使用 RxJava + MVP 组合方式，重构完成 <a href="https://github.com/whiskeyfei/SimpleNews.io" target="_blank" rel="noopener">SimpleNews.io</a>，目前还存在很多需要优化的地方，今天说说 SimpleNews.io 中用到的 MVP 部分。</p>
<p>参考 <a href="https://github.com/ribot/android-boilerplate" target="_blank" rel="noopener">android-boilerplate</a>, 添加 base Presenter 和 base View,以后所有的 Presenter 和 View 都需要继承 base ,这样在Presenter这一层才能使用统一方法回调接口，Model 暂时没有改变</p>
<h3 id="好处"><a href="#好处" class="headerlink" title="好处"></a>好处</h3><p>1、BasePresenter 将不同的view接口统一，不返回具体的view接口，通过方法操作，易于扩展;<br><br>2、view 接口的绑定统一化;</p>
<h3 id="基础使用"><a href="#基础使用" class="headerlink" title="基础使用"></a>基础使用</h3><p>定义View接口，暂时为空，子类可以扩展添加</p>
<pre><code>public interface IMVPBaseView {

}
</code></pre><p>定义Presenter接口</p>
<pre><code>public interface IMVPPresenter&lt;V extends IMVPBaseView&gt; {
    /**
     * 附加view回调接口
     *
     * @param mvpBaseView
     */
    void attachView(V mvpBaseView);

     /**
     * 释放view接口
     */
    void detachView();

}
</code></pre><p>BasePresenter实现</p>
<pre><code>public class BasePresenter&lt;T extends IMVPBaseView&gt; implements IMVPPresenter&lt;T&gt; {
    private T mMvpBaseView;

    @Override
    public void attachView(T mvpBaseView) {
        mMvpBaseView = mvpBaseView;
    }

    @Override
    public void detachView() {
        mMvpBaseView = null;
    }

    public T getMvpBaseView() {
        return mMvpBaseView;
    }

    /**
     * 是否附加view接口
     *
     * @return true mvpBaseView != null
     */
    public boolean isViewAttached() {
        return mMvpBaseView != null;
    }

    /**
     * 检查是否绑定view接口
     */
    public void checkViewAttached() {
        if (!isViewAttached())
            throw new RuntimeException(
                    &quot;Please call BasePresenter.attachView(IMVPBaseView) before&quot;
                            + &quot; requesting data to the Presenter&quot;);
    }
}
</code></pre><h3 id="项目使用"><a href="#项目使用" class="headerlink" title="项目使用"></a>项目使用</h3><p>首先看下我的项目结构:</p>
<p><img src="!--￼0--&gt;/assets/image/mvp.png" alt="mvp"></p>
<p>拿获取图片列表来举例，逻辑是这样：获取数据并解析结果给 view 展示。首先在 Fragment 中即 View 接口的实现类中<br>初始化我们的 Presenter 同时会初始化一个 Model，Fragment 调用 Presenter 中的方法，例如：loadImageList() 方法，接着去调用 Model中<br>的getImageList()方法,最后 Model 讲结果回调给 Presenter 层，Presenter 再回调给 View层，这样就完成了一个 MVP逻辑，以下是部分代码。</p>
<pre><code>//View
private IImagePresenter mImagePresenter;

@Override
public void onCreate(@Nullable Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    mImagePresenter = new ImagePresenter(this);
}

//Presenter
public class ImagePresenter extends BasePresenter&lt;IImageView&gt; implements IImagePresenter {
private static final String TAG = &quot;ImagePresenter&quot;;
private IImageModel mImageModel;
private Subscription mSubscription;

public ImagePresenter(IImageView imageView) {
    attachView(imageView);
    mImageModel = new ImageModel();
}

@Override
public void detachView() {
    super.detachView();
    if (mSubscription != null) {
        mSubscription.unsubscribe();
    }
}

@Override
public void loadImageList() {
    checkViewAttached();
    mSubscription = mImageModel.getImageList()
            .subscribeOn(Schedulers.io())
            .doOnSubscribe(new Action0() {
                @Override
                public void call() {
                    getMvpBaseView().showProgress();
                }
            })
            .observeOn(AndroidSchedulers.mainThread())
            .subscribe(new Observer&lt;List&lt;ImageBean&gt;&gt;() {
                @Override
                public void onCompleted() {
                    getMvpBaseView().hideProgress();
                }

                @Override
                public void onError(Throwable e) {
                    getMvpBaseView().hideProgress();
                    getMvpBaseView().showLoadFailMsg();
                }

                @Override
                public void onNext(List&lt;ImageBean&gt; list) {
                    getMvpBaseView().onSuccess(list);
                }
            });
    }
}

//Model
public class ImageModel implements IImageModel {

    private static final String TAG = &quot;ImageModel&quot;;

    public Observable&lt;List&lt;ImageBean&gt;&gt; getImageList() {
        return Observable.just(Urls.IMAGES_URL).flatMap(new Func1&lt;String, Observable&lt;List&lt;ImageBean&gt;&gt;&gt;() {
            @Override
            public Observable&lt;List&lt;ImageBean&gt;&gt; call(final String url) {
                //可以拼接url
                return Observable.create(new Observable.OnSubscribe&lt;List&lt;ImageBean&gt;&gt;() {

                    @Override
                    public void call(final Subscriber&lt;? super List&lt;ImageBean&gt;&gt; subscriber) {
                        OkHttpUtils.ResultCallback&lt;String&gt; loadNewsCallback = new OkHttpUtils.ResultCallback&lt;String&gt;() {
                            @Override
                            public void onSuccess(String response) {
                                Log.d(TAG, &quot;onSuccess response:&quot; + response);
                                if(StringUtils.isEmpty(response)){
                                    subscriber.onError(null);
                                    return;
                                }
                                Gson gson = new Gson();
                                List&lt;ImageBean&gt; iamgeBeanList = gson.fromJson(response, new TypeToken&lt;List&lt;ImageBean&gt;&gt;() {}.getType());
                                if(ListUtils.isEmpty(iamgeBeanList)){
                                    subscriber.onError(null);
                                    return;
                                }
                                subscriber.onNext(iamgeBeanList);
                                subscriber.onCompleted();
                            }

                            @Override
                            public void onFailure(Exception e) {
                                subscriber.onError(e);
                            }
                        };
                        OkHttpUtils.get(url, loadNewsCallback);
                    }
                });
            }
        });
    }
}
</code></pre><p>一个完整的MVP思想的使用就结束了，有没有觉得很简单，最初听名字以为是一个框架，学了才知道 MVP 是一种思想，开发多多使用，有问题欢迎留言，<br>也可以frok我的项目 <a href="https://github.com/whiskeyfei/SimpleNews.io" target="_blank" rel="noopener">SimpleNews.io</a> 一起学习。</p>
<h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><ul>
<li><a href="http://rocko.xyz/2015/11/07/MVVM_Android-CleanArchitecture/" target="_blank" rel="noopener">MVVM_Android-CleanArchitecture</a></li>
<li><a href="http://rocko.xyz/2015/02/06/Android%E4%B8%AD%E7%9A%84MVP/" target="_blank" rel="noopener">Android中的MVP</a></li>
<li><a href="http://toughcoder.net/blog/2015/11/29/understanding-android-mvp-pattern/" target="_blank" rel="noopener">说说Android的MVP模式</a>文章中有些话，摘自<a href="http://toughcoder.net/blog/2015/11/29/understanding-android-mvp-pattern/" target="_blank" rel="noopener">说说Android的MVP模式</a>一文</li>
<li><a href="https://github.com/ribot/android-boilerplate" target="_blank" rel="noopener">android-boilerplate</a></li>
</ul>
<h3 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h3><ul>
<li><a href="https://github.com/whiskeyfei/WFAndroidDemo/tree/master/WFAndroid_MVP" target="_blank" rel="noopener">WFAndroid_MVP</a> MVP Demo</li>
<li><a href="https://github.com/whiskeyfei/SimpleNews.io" target="_blank" rel="noopener">SimpleNews.io</a> 我的项目</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://whiskeyfei.github.io/2015/11/10/tech/2015-11-26-android-technology-website/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="無名">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/face.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="無名小子的杂货铺">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/10/tech/2015-11-26-android-technology-website/" itemprop="url">日常技术博客收集</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-11-10T19:28:39+09:00">2015-11-10</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/日常/" itemprop="url" rel="index"><span itemprop="name">日常</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>收集开发中经常看的博客或者技术帖</p>
<p>1、<a href="http://gank.io/" target="_blank" rel="noopener">干货集中营</a> 每日推荐Android、ios、app等开源库<br><br>2、<a href="http://www.liaoxuefeng.com/" target="_blank" rel="noopener">廖雪峰的官方网站</a> Python、git、js等教程，值得一看<br><br>3、<a href="http://codekk.com/open-source-project-analysis" target="_blank" rel="noopener">Codekk源码</a> 开源项目解析<br><br>4、<a href="http://hukai.me/" target="_blank" rel="noopener">胡凯个人网站</a> google课程翻译、性能优化等<br><br>5、<a href="http://www.stormzhang.com/" target="_blank" rel="noopener">stormzhang博客精华</a> AS教程、android开发等<br><br>6、<a href="http://rocko.xyz/" target="_blank" rel="noopener">Rocko</a> Android Developer技术文章等<br><br>7、<a href="http://blog.coderzh.com/" target="_blank" rel="noopener">coderzh CoderZh Blog</a> coderzh CoderZh Blog读书笔记个人文章等<br><br>8、<a href="http://droidyue.com/" target="_blank" rel="noopener">技术小黑屋</a><br><br>9、<a href="https://drakeet.me/" target="_blank" rel="noopener">Drakeet的个人博客</a><br><br>10、<a href="http://www.jcodecraeer.com/" target="_blank" rel="noopener">泡在网上的日子</a><br><br>–未完待续，如果有丢失链接得请告知，谢谢！</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://whiskeyfei.github.io/2015/11/10/android/2015-11-11-android-viewstub/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="無名">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/face.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="無名小子的杂货铺">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/10/android/2015-11-11-android-viewstub/" itemprop="url">Android ViewStub、include、merge 标签使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-11-10T19:28:39+09:00">2015-11-10</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Android/" itemprop="url" rel="index"><span itemprop="name">Android</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>总结两个在 Android 局优化中用到的标签，ViewStub 和 include，通过使用这些标签来使布局文件的到重用，嵌到别的布局中，include标签用途：引入重复布局，使布局得到复用。<br>ViewStub：默认不可见，使用时才真正加载，避免创建无用的 view 来消耗系统资源。</p>
<h2 id="1、include-使用"><a href="#1、include-使用" class="headerlink" title="1、include 使用"></a>1、include 使用</h2><pre><code>&lt;include
      android:id=&quot;@+id/top_layout_id&quot;
      android:layout_width=&quot;match_parent&quot;
      android:layout_height=&quot;wrap_content&quot;
      layout=&quot;@layout/title_top_layout&quot; /&gt;

  /**
   * 直接通过this查找，因为include已经转换成layout中的布局
   */
  private void methodTwo() {
      TextView textView = (TextView)findViewById(R.id.textview);
      textView.setText(&quot;Top Title Two&quot;);
  }

  /**
   *  通过mView查找子view控件,mView为layout布局
   */
  private void methodOne() {
      ImageView imageView = (ImageView) mView.findViewById(R.id.imageview);
      TextView textView = (TextView) mView.findViewById(R.id.textview);
      textView.setText(&quot;Top Title One&quot;);
  }
</code></pre><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul>
<li>注意标签是是 layout,和 viewStub 区分;</li>
<li>如果 include 设置了 Id 则需要通过 Id 来查找目标布局的根元素;</li>
</ul>
<hr>
<h2 id="二、ViewStub"><a href="#二、ViewStub" class="headerlink" title="二、ViewStub"></a>二、ViewStub</h2><p>ViewStub用途:布局优化，开发中经常听说view优化，但是真正用到得ViewStub可能不多，做下记录，今天优化代码将ViewStub加入,include标签就不用说了,开发经常用的标签，简单的包含父布局；</p>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><pre><code>&lt;ViewStub android:id=&quot;@+id/stub&quot;
   android:inflatedId=&quot;@+id/subTree&quot;
   android:layout=&quot;@layout/mySubTree&quot;
   android:layout_width=&quot;120dip&quot;
   android:layout_height=&quot;40dip&quot; /&gt;

ViewStub stub = (ViewStub) findViewById(R.id.stub);
View view = stub.inflate();//这里的view就是include进来的view

//这里的设置了inflatedId则通过inflatedId来获取子view
</code></pre><h3 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>延迟加载或者很少几率才用到得view布局，比如:错误信息显示、占位等;</li>
<li>遇到重复的view布局，通过android:layout引入;</li>
<li>存在两者取其一等类似情况，没必要都初始化好;</li>
</ul>
<h3 id="注意事项-1"><a href="#注意事项-1" class="headerlink" title="注意事项"></a>注意事项</h3><ul>
<li>inflate()被调用之后，返回的是父布局控件对象,不能再次调用inflate();</li>
<li>注意标签是android:layout不是layout,和include区分;</li>
<li>可以使用inflatedId重写ViewStub的父布局控件的Id,也就是说,如果ViewStup设置了inflatedId则需要通过inflatedId来查找目标布局的根元素;</li>
</ul>
<p>ViewStub源码:</p>
<pre><code>public View inflate() {
    final ViewParent viewParent = getParent();

    if (viewParent != null &amp;&amp; viewParent instanceof ViewGroup) {
        if (mLayoutResource != 0) {
            final ViewGroup parent = (ViewGroup) viewParent;
            final LayoutInflater factory = LayoutInflater.from(mContext);
            final View view = factory.inflate(mLayoutResource, parent,
                    false);
            //NO_ID＝－1即没有获取到mInflatedId
            if (mInflatedId != NO_ID) {
                view.setId(mInflatedId);
                //如果ViewStub的inflatedId不是NO_ID（－1）则把inflatedId设置为目标布局根元素的id,也就是layout根布局的id
            }

            final int index = parent.indexOfChild(this);
            parent.removeViewInLayout(this);
            final ViewGroup.LayoutParams layoutParams = getLayoutParams();
            if (layoutParams != null) {
                parent.addView(view, index, layoutParams);
            } else {
                parent.addView(view, index);
            }

            mInflatedViewRef = new WeakReference&lt;View&gt;(view);

            if (mInflateListener != null) {
                mInflateListener.onInflate(this, view);
            }

            return view;
        } else {
            throw new IllegalArgumentException(&quot;ViewStub must have a valid layoutResource&quot;);
        }
    } else {
        throw new IllegalStateException(&quot;ViewStub must have a non-null ViewGroup viewParent&quot;);
    }
}
</code></pre><h2 id="三、merge"><a href="#三、merge" class="headerlink" title="三、merge"></a>三、merge</h2><p>主要目的是为了减少在 include 布局文件时的层级，例如：如果您的布局中嵌套了两层 LinearLayout ，这时候就存在布局冗余情况，<br>需要使用 merge 标签来减少布局层级，同时还能优化 UI 性能，因为多一层 view 就会多影响渲染性能。</p>
<h3 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h3><p>merge_main.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:orientation=&quot;vertical&quot; &gt;

    &lt;include
        android:id=&quot;@+id/news_title&quot;
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;match_parent&quot;
        layout=&quot;@layout/merge_item&quot; /&gt;

&lt;/LinearLayout&gt;
</code></pre><p>merge_item.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;merge xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; &gt;

    &lt;Button
        android:layout_width=&quot;fill_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:text=&quot;merge1&quot; /&gt;

    &lt;Button
        android:layout_width=&quot;fill_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:text=&quot;merge2&quot; /&gt;

&lt;/merge&gt;
</code></pre><h3 id="前后对比"><a href="#前后对比" class="headerlink" title="前后对比"></a>前后对比</h3><p>主要是消除 LinearLayout 层级</p>
<p><img src="!--￼0--&gt;/merge1.png" alt="不使用merge"></p>
<p><img src="!--￼1--&gt;/merge2.png" alt="使用merge"></p>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>注意标签是layout,如果使用了 android:layout，则会报错</p>
<pre><code>Exception raised during rendering:
You must specifiy a layout in the include tag: &lt;include layout=&quot;@layout/layoutID&quot; /&gt;
</code></pre><h2 id="四、Demo"><a href="#四、Demo" class="headerlink" title="四、Demo"></a>四、Demo</h2><p>代码是最好的老师，<a href="https://github.com/whiskeyfei/WFAndroidDemo/tree/master/WPLayoutImp" target="_blank" rel="noopener">点我点我</a></p>
<h2 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a>五、总结</h2><p>官方说明 ViewStub 本质就是一个高度为0个View，默认不可见，只有通过调用setVisibility函数或者Inflate函数才会将其要装载的目标布局给加载出来,从而达到延迟加载效果，不需要的时候也可以不加载</p>
<h2 id="推荐文章"><a href="#推荐文章" class="headerlink" title="推荐文章"></a>推荐文章</h2><ul>
<li><a href="http://developer.android.com/intl/zh-cn/reference/android/view/ViewStub.html" target="_blank" rel="noopener">Google ViewStub reference</a></li>
<li><a href="http://blog.csdn.net/hitlion2008/article/details/6737537" target="_blank" rel="noopener">ViewStub的应用</a></li>
<li><a href="http://www.cnblogs.com/menlsh/archive/2013/03/17/2965217.html" target="_blank" rel="noopener">使用惰性控件ViewStub实现布局动态加载</a></li>
<li><a href="http://blog.csdn.net/bboyfeiyu/article/details/45869393#t2" target="_blank" rel="noopener">Android布局优化之ViewStub、include、merge使用与源码分析</a></li>
<li><a href="https://github.com/whiskeyfei/WFAndroidDemo/tree/master/WPLayoutImp" target="_blank" rel="noopener">本文案例</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://whiskeyfei.github.io/2015/11/10/tech/2015-11-26-java-base/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="無名">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/face.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="無名小子的杂货铺">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/10/tech/2015-11-26-java-base/" itemprop="url">Java基础日常记录</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-11-10T19:28:39+09:00">2015-11-10</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/日常/" itemprop="url" rel="index"><span itemprop="name">日常</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Java 基础日常记录，都是一些在开发中经常使用得概念，整理整理，以后复习,目前包含：泛型、观察者模式、序列化、简单数据结构。</p>
<h2 id="一-、Java中泛型使用"><a href="#一-、Java中泛型使用" class="headerlink" title="一 、Java中泛型使用"></a>一 、Java中泛型使用</h2><p>1、首先我们来一个例子，由此来引出泛型的概念</p>
<pre><code>public static void main(String[] args) {
      List list = new ArrayList();
      list.add(&quot;1&quot;);
      //list.add(false);//1
      list.add(100);//2
      int len = list.size();
      for (int i = 0; i &lt; len; i++) {
          String value = (String) list.get(i); // 1
          System.out.println(&quot;value:&quot; + value);
      }
  }
</code></pre><p>以上代码就不用解释了，大家一看就明白，但是会出异常,信息如下</p>
<p>代码1处：</p>
<pre><code>value:1Exception in thread &quot;main&quot;
java.lang.ClassCastException: java.lang.Boolean cannot be cast to java.lang.String
    at MianTest.main(MianTest.java:16)
</code></pre><p>代码2处：</p>
<pre><code>value:1
Exception in thread &quot;main&quot; java.lang.ClassCastException: java.lang.Integer cannot be cast to java.lang.String
    at MianTest.main(MianTest.java:16)
</code></pre><p>以上代码存在两个问题：</p>
<ul>
<li>集合不会记住此对象的类型</li>
<li>强制转换类型会出错</li>
</ul>
<p>2、泛型</p>
<p>泛型，即“参数化类型”一提到参数，最熟悉的就是定义方法时有形参，然后调用此方法时传递实参。<br>顾名思义，就是将类型由原来的具体的类型参数化，类似于方法中的变量参数，此时类型也定义成参数形式（可以称之为类型形参），然后在使用/调用时传入具体的类型(类型实参),<br>常常用T、E、K、V等形式的参数常用于表示泛型形参，用来接收来自外部使用时候传入的类型实参<br></p>
<p>T为形参，外部可以传进来实参</p>
<pre><code>public class GenericModel&lt;T&gt; {
    private T mData;

    public GenericModel(T t) {
        this.mData = t;
    }

    public T getData() {
        return mData;
    }

    public void setmata(T mData) {
        this.mData = mData;
    }

}
</code></pre><p>具体使用：</p>
<pre><code>public static void main(String[] args) {
        GenericModel&lt;Boolean&gt; z = new GenericModel&lt;Boolean&gt;(false);
         GenericModel&lt;String&gt; one = new GenericModel&lt;String&gt;(&quot;1&quot;);
         GenericModel&lt;Integer&gt; two = new GenericModel&lt;Integer&gt;(1);
         System.out.println(&quot;z&quot;+z.getData());
         System.out.println(&quot;one&quot;+one.getData());
         System.out.println(&quot;two&quot;+two.getData());
}
</code></pre><p>结果：</p>
<pre><code>zfalse
oneaaa
two1
</code></pre><p>问题1: 那么对于不同传入的类型实参，生成的相应对象实例的类型是不是一样的呢？<br><br>      答:泛型类型在逻辑上看以看成是多个不同的类型，实际上都是相同的基本类型</p>
<h5 id="3、补充"><a href="#3、补充" class="headerlink" title="3、补充"></a>3、补充</h5><p>我们发现，在使用泛型类时，虽然传入了不同的泛型实参，但并没有真正意义上生成不同的类型，传入不同泛型实参的泛型类在内存上只有一个，即还是原来的最基本的类型，当然，在逻辑上我们可以理解成多个不同的泛型类型，究其原因，在于Java中的泛型这一概念提出的目的，导致其只是作用于代码编译阶段，在编译过程中，对于正确检验泛型结果后，会将泛型的相关信息擦出，也就是说，成功编译过后的class文件中是不包含任何泛型信息的。泛型信息不会进入到运行时阶段。</p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><ul>
<li><a href="http://www.cnblogs.com/lwbqqyumidi/p/3837629.html" target="_blank" rel="noopener">感谢Java总结篇系列：Java泛型</a></li>
<li><a href="https://github.com/whiskeyfei/Node-for-Android/tree/master/demo/%E6%B3%9B%E5%9E%8B" target="_blank" rel="noopener">Node-for-Android</a></li>
</ul>
<hr>
<h2 id="二、设计模式－观察者模式-java"><a href="#二、设计模式－观察者模式-java" class="headerlink" title="二、设计模式－观察者模式(java)"></a>二、设计模式－观察者模式(java)</h2><p>当对象间存在一对多关系时，则使用观察者模式（Observer Pattern）<br>比如，当一个对象被修改时，则会自动通知它的依赖对象，观察者模式属于行为型模式。</p>
<h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><p>在 java 中实现观察者模式需要用到 java.util 包中提供的 Observable 类和 Observer 接口，java 已经给我们提供好类使用。<br>Observable 可以查看 java 源码，下面是 Observer 接口</p>
<pre><code>/**
 * {@code Observer} is the interface to be implemented by objects that
 * receive notification of updates on an {@code Observable} object.
 *
 * @see Observable
 */
public interface Observer {

    /**
     * This method is called if the specified {@code Observable} object&apos;s
     * {@code notifyObservers} method is called (because the {@code Observable}
     * object has been updated.
     *
     * @param observable
     *            the {@link Observable} object.
     * @param data
     *            the data passed to {@link Observable#notifyObservers(Object)}.
     */
    void update(Observable observable, Object data);
}
</code></pre><h3 id="Demo-实例"><a href="#Demo-实例" class="headerlink" title="Demo 实例"></a>Demo 实例</h3><p>古董被观察，观察者为 people 用来观察古董价钱波动</p>
<ul>
<li>被观察者需要继承 Observable</li>
<li><p>维护内部数据即可</p>
<p>  public class Antique extends Observable {</p>
<pre><code>private float mPrice;// 价钱

public Antique(float price) {
    this.mPrice = price;
}

public float getPrice() {
    return this.mPrice;
}

public void setPrice(float price) {
    super.setChanged();
    super.notifyObservers(price);// 价格被改变
    this.mPrice = price;
}

public String toString() {
    return &quot;古董价格为：&quot; + this.mPrice;
}
</code></pre><p>  }</p>
</li>
</ul>
<p>观察者实现 Observer 接口，重写 update 方法即可;</p>
<pre><code>public class People implements Observer{

    private String name;

    public People(String name) {
        this.name = name;
    }

    @Override
    public void update(Observable observable, Object data) {
        Log.e(&quot;&quot;,&quot;People update() -&gt; update name:&quot;+ this.name + &quot;,price:&quot;+ ((Float)data).floatValue());
    }

}
</code></pre><p>主函数调用</p>
<pre><code>Antique house = new Antique(1222f);
People p1 = new People(&quot;p1&quot;);
People p2 = new People(&quot;p2&quot;);
People p3 = new People(&quot;p3&quot;);
house.addObserver(p1);
house.addObserver(p2);
house.addObserver(p3);
Log.e(&quot;&quot;, house+&quot;&quot;); // 输出价格
house.setPrice(111f);
Log.e(&quot;&quot;, house+&quot;&quot;); // 输出价格
</code></pre><h3 id="感谢"><a href="#感谢" class="headerlink" title="感谢"></a>感谢</h3><ul>
<li><a href="http://www.runoob.com/design-pattern/observer-pattern.html" target="_blank" rel="noopener">设计模式</a></li>
<li><a href="http://www.2cto.com/kf/201310/253013.html" target="_blank" rel="noopener">Java常用类库–观察者设计模式(Observable类Observer接口)</a></li>
</ul>
<p>###<a href="https://github.com/whiskeyfei/Node-for-Android/tree/master/demo/%E8%A7%82%E5%AF%9F%E8%80%85" target="_blank" rel="noopener">Node-for-Android</a></p>
<hr>
<h2 id="三、Java-序列化"><a href="#三、Java-序列化" class="headerlink" title="三、Java 序列化"></a>三、Java 序列化</h2><p>Java提供了一种对象序列化的机制，该机制中，一个对象可以被表示为一个字节序列，该字节序列包括该对象的数据、有关对象的类型的信息和存储在对象中数据的类型。将序列化对象写入文件之后，可以从文件中读取出来，并且对它进行反序列化，也就是说，对象的类型信息、对象的数据，还有对象中的数据类型可以用来在内存中新建对象,简单了说就是存储对象和读取对象</p>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p>序列化对象并反序列化</p>
<pre><code>String path = this.getFilesDir().getAbsolutePath() + File.separator + &quot;data&quot;;
    Student sdudent = new Student(&quot;user&quot;,&quot;234&quot;);
    SerializableUtils.serialization(path, sdudent);
    Student student1 = (Student) SerializableUtils.deserialization(path);
    Log.e(&quot;&quot;, &quot;student1&quot;+student1.getName());

//model实现Serializable
public class Student implements Serializable {

    private static final long serialVersionUID = 1L;
    private String name;
    private String score;

    public Student(String name, String score) {
        this.name = name;
        this.score = score;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getScore() {
        return score;
    }

    public void setScore(String score) {
        this.score = score;
    }

}
</code></pre><p>序列化工具类（SerializableUtils）</p>
<pre><code>public class SerializableUtils {
    public SerializableUtils() {
        throw new AssertionError();
    }

    /**
     * Write Serializable datas
     *
     * @param rsls
     * @param fileName
     * @param context
     * @throws IOException
     */
    @SuppressWarnings(&quot;deprecation&quot;)
    @SuppressLint(&quot;WorldReadableFiles&quot;)
    public static void write(Context context, Object rsls, String fileName)throws IOException {
        FileOutputStream fileOutputStream = context.openFileOutput(fileName,Context.MODE_WORLD_READABLE);
        ObjectOutputStream objectOutputStream = new ObjectOutputStream(fileOutputStream);
        objectOutputStream.writeObject(rsls);
        objectOutputStream.flush();
        objectOutputStream.close();
        fileOutputStream.close();
    }

    /**
     * Read Serializable datas
     *
     * @param fileName
     * @return
     * @throws Exception
     */
    public static Object read(Context context, String fileName)throws Exception {
        FileInputStream fileInputStream = context.openFileInput(fileName);
        ObjectInputStream objectInputStream = new ObjectInputStream(fileInputStream);
        Object object = objectInputStream.readObject();
        objectInputStream.close();
        fileInputStream.close();
        return object;
    }

    /**
     * serialize to file
     *
     * @param filePath
     * @param obj model mast be implements Serializable
     * @throws RuntimeException if an error occurs
     */
    public static void serialization(String filePath, Object obj) {
        ObjectOutputStream out = null;
        try {
            out = new ObjectOutputStream(new FileOutputStream(filePath));
            out.writeObject(obj);
            out.close();
        } catch (FileNotFoundException e) {
            throw new RuntimeException(&quot;serialization() -&gt; FileNotFoundException occurred.&quot;,e);
        } catch (IOException e) {
            throw new RuntimeException(&quot;serialization() -&gt; IOException occurred&quot;,e);
        } finally{
            if (out != null) {
                try {
                    out.close();
                } catch (IOException e) {
                    throw new RuntimeException(&quot;serialization() -&gt; IOException occurred. &quot;, e);
                }
            }
        }
    }

    /**
     * deserialization from file
     *
     * @param filePath
     * @return object implements Serializable
     * @throws RuntimeException if an error occurs
     */
    public static Object deserialization(String filePath){
        ObjectInputStream in = null;
        try {
            in = new ObjectInputStream(new FileInputStream(filePath));
            Object object = in.readObject();
            in.close();
            return object;
        } catch (FileNotFoundException e) {
            throw new RuntimeException(&quot;deserialization() -&gt; FileNotFoundException occurrd&quot;,e);
        }catch (ClassNotFoundException e) {
            throw new RuntimeException(&quot;deserialization() -&gt; ClassNotFoundException occurrd&quot;,e);
        }catch (IOException e) {
            throw new RuntimeException(&quot;deserialization() -&gt; IOException occurrd&quot;,e);
        }
        finally{
            try {
                if (in != null) {
                    in.close();
                }
            } catch (IOException e) {
                throw new RuntimeException(&quot;IOException occurrd&quot;,e);
            }
        }
    }

}
</code></pre><h3 id="感谢-1"><a href="#感谢-1" class="headerlink" title="感谢"></a>感谢</h3><ul>
<li><p><a href="http://www.runoob.com/java/java-serialization.html" target="_blank" rel="noopener">Java 序列化</a></p>
</li>
<li><p><a href="https://github.com/whiskeyfei/Node-for-Android/tree/master/demo/%E5%BA%8F%E5%88%97%E5%8C%96" target="_blank" rel="noopener">Node-for-Android</a></p>
</li>
</ul>
<hr>
<p>##五、Java数据结构</p>
<p>线性表，链表，集合是常用的数据结构，关键字Arrays、Array(线性序列)接口 Collection，Map,平时用的最多的有 ArrayList、HashMap、HashSet、LinkedList，针对不同的场景选择不同的容器，最大可能提高cpu使用率和降低内存使用。</p>
<ul>
<li>Arrays、Array</li>
<li>Collection: List、Set、Queue</li>
<li>Map: HashMap、HashTable</li>
</ul>
<h3 id="选择及注意"><a href="#选择及注意" class="headerlink" title="选择及注意"></a>选择及注意</h3><ul>
<li>固定数量试用Array，我们都承认Java中效率最高的存储方式就是使用数组</li>
<li>如果涉及到堆栈、队列等操作，应该考虑用List，对于需要快速插入，删除元素，应该使用LinkedList，如果需要快速随机访问元素，应该使用ArrayList;</li>
<li>如果程序在单线程环境中，或者访问仅仅在一个线程中进行，考虑非同步的类，其效率较高，如果多个线程可能同时操作一个类，应该使用同步的类;</li>
<li>要特别注意对哈希表的操作，作为key的对象要正确复写 equals 和 hashCode方法;</li>
<li>尽量返回接口而非实际的类型，如返回List而非 ArrayList，这样如果以后需要将ArrayList换成 LinkedList时，客户端代码不用改变。这就是针对抽象编程;</li>
<li>善用 Arrays.asList 方法，此方法成为数组和 Collection 等集合类间的桥梁，只要有这两种方法 Array 和 Collection就可以相互转换</li>
<li>HashTable(同步)，key和value都不允许出现null值</li>
<li>Set不可重复，最多只有一个null</li>
<li>HashMap中，null可以作为键，这样的键只有一个，可以有一个或多个键所对应的值为null，当get()方法返回null值时，即可以表示HashMap中没有该键，也可以表示该键所对应的值为null。因此，在HashMap中不能由get()方法来判断HashMap中是否存在某个键， 而应该用containsKey()方法来判断。</li>
</ul>
<h3 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h3><pre><code>//LinkedList 适用于快速插入删除等操作
@Test
public void test1() {
    List&lt;String&gt; list = new LinkedList&lt;String&gt;();
    list.add(&quot;1&quot;);
    list.add(&quot;2&quot;);
    list.add(&quot;3&quot;);
    list.add(&quot;4&quot;);
    list.add(&quot;5&quot;);

    // 遍历方法1
    // int len = list.size();
    // for (int i = 0; i &lt; len; i++) {
    // System.out.println(list.get(i));
    // }
    // 遍历方法1
    Iterator&lt;String&gt; l = list.iterator();// 获得一个迭代子
    while (l.hasNext()) {
        System.out.println(l.next());// 得到下一个元素
    }
}

//ArrayList 快速获取子元素
@Test
public void test2() {
    List&lt;String&gt; list = new ArrayList&lt;String&gt;();
    list.add(&quot;1&quot;);
    list.add(&quot;2&quot;);
    list.add(&quot;3&quot;);
    list.add(&quot;4&quot;);
    list.add(&quot;5&quot;);

    int len = list.size();
    for (int i = 0; i &lt; len; i++) {
        System.out.println(list.get(i));
    }
}

//HashMap key不能相同，value可相同
@Test
public void test3() {
    Map&lt;Integer, String&gt; map = new HashMap&lt;Integer, String&gt;();
    map.put(1, &quot;1&quot;);
    map.put(2, &quot;2&quot;);
    map.put(3, &quot;3&quot;);
    Iterator&lt;Entry&lt;Integer, String&gt;&gt; iterator = map.entrySet().iterator();
    while (iterator.hasNext()) {
        Entry&lt;Integer, String&gt; next = iterator.next();//键值对
        int key = next.getKey();
        String value = next.getValue();
        System.out.println(&quot;key:&quot; + key + &quot;values:&quot; + value);
    }
}
//hashSet 不可重复
@Test
public void test4() {
    Set&lt;String&gt; set = new HashSet&lt;String&gt;();
    set.add(&quot;1&quot;);
    set.add(&quot;2&quot;);
    set.add(&quot;3&quot;);
    Iterator&lt;String&gt; iterator = set.iterator();
    while (iterator.hasNext()) {
        String next = iterator.next();
        System.out.println(next);
    }
}
</code></pre><h2 id="参考内容"><a href="#参考内容" class="headerlink" title="参考内容"></a>参考内容</h2><ul>
<li><a href="http://developer.51cto.com/art/201107/273003.htm" target="_blank" rel="noopener">详细介绍java中的数据结构</a></li>
<li><a href="http://developer.51cto.com/art/201107/274951.htm" target="_blank" rel="noopener">详细介绍java中的集合框架</a></li>
<li><a href="http://blog.csdn.net/zsw101259/article/details/7570033" target="_blank" rel="noopener">集合_java集合框架</a></li>
<li><a href="http://www.cnblogs.com/ayan/archive/2012/04/16/2451949.html" target="_blank" rel="noopener">Java数据结构内容整理</a></li>
<li><a href="http://cping1982.blog.51cto.com/601635/130062" target="_blank" rel="noopener">浅谈Java集合中Array(数组)的应用</a></li>
<li><a href="http://www.cnblogs.com/devinzhang/archive/2012/01/13/2321481.html" target="_blank" rel="noopener">Java的HashMap和HashTable</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://whiskeyfei.github.io/2015/11/10/android/2015-11-17-android-use-mvp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="無名">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/face.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="無名小子的杂货铺">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/10/android/2015-11-17-android-use-mvp/" itemprop="url">Android MVP 简单使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-11-10T19:28:39+09:00">2015-11-10</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Android/" itemprop="url" rel="index"><span itemprop="name">Android</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>前段时间接了一个模块，使用 MVP 思想来优化，考虑到不能太多的影响现有模块功能和其他调用方式，没有做太大的改动，只是将流程进行了梳理和优化，直接上案例。</p>
<p><em>MVP</em> 是一套理论概念，而不是一种具体实现,需要注意 MVP 仅用于应用中的 GUI 部分，它并不是整个应用的架构方式，一个应用的主要的架构应该包括基础组件，业务逻辑层和 GUI 展示层，而 MVP仅是用于展示层的设计模式。另外，它是一个方法论的东西，没有固定的实现方式，只要能体现出它的方法就可以算是 MVP。</p>
<h2 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h2><p>简单说下 MVC(Model-View-Controller), MVC 在网站开发中用的多，以前用 Thinkphp 时就是 MVC，MVC 机构分为三部分，实体层的 Model，视图层的 View，控制层的 Controller。<br>View 就是我们看到的程序界面，接受用户的操作，Model 就是数据，Controller 用于更新 View 和 Model。<br>这样三部分都将自己的业务分开，不必干扰其他模块部分，和设计模式当中类功能的单一职责相似。</p>
<h2 id="MVP"><a href="#MVP" class="headerlink" title="MVP"></a>MVP</h2><p>MVP 模式（Model-View-Presenter）应该是 MVC 在 Android开发上的一种变化模式，其思想是一样的，都是将三层业务分离。<br>View 对应 Activity，业务逻辑 Presenter，Model 还是数据。<br>这样划分以后，三层工作逻辑很清晰，view 只管相应用户等系统事件，具体操作全都丢到 Persenter 中，而 view 不能直接操作 model，需要通过 Presenter 中转。</p>
<h2 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h2><ul>
<li>分离了 Activity 中的 UI 和业务逻辑，降低了耦合程度，以后如果更换view层会很方便，因为UI层和业务层互不影响，只存在一个调用关系;</li>
<li>业务逻辑层代码可以复用，降低了维护成本;</li>
<li>增强了代码的可读性，一层一层调用会很清晰;</li>
<li>可以进行单元测试，通过后和 UI 层在进行合并，提高效率;</li>
</ul>
<h2 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h2><ul>
<li>不能为了接口而抽象,适当的抽象;</li>
<li>考虑业务是否符合 MVP;</li>
<li>view 过多时,不建议使用 MVP ,view 增多导致 Presenter 增多,从而不以维护，不过一般 view 也不会太多;</li>
</ul>
<h2 id="约束条件"><a href="#约束条件" class="headerlink" title="约束条件"></a>约束条件</h2><ul>
<li>Model 与 View 不能直接通信，只能通过 Presenter;</li>
<li>Model 和 View 是接口，Presenter 持有的是一个 Model 接口和一个 View 接口;</li>
<li>Model 和 View 都应该是被动的，一切都由 Presenter 来主导;</li>
<li>Model 应该把与业务逻辑层的交互封装掉，换句话说 Presenter 和 View 不应该知道业务逻辑层；</li>
<li>View 的逻辑应该尽可能的简单，不应该有状态。当事件发生时，调用 Presenter 来处理，并且不传参数，Presenter 处理时再调用 View 的方法来获取;</li>
</ul>
<h2 id="具体使用"><a href="#具体使用" class="headerlink" title="具体使用"></a>具体使用</h2><p>定义View接口</p>
<pre><code>public interface IMainView {
  /**
   * view 显示文字
   * @param text
   */
  void showTextView(String text);
  }
</code></pre><p>定义Presenter接口</p>
<pre><code>  public interface IMainPresenter {
    /**
     * 显示文字事件分发
     */
    void show();
}
</code></pre><p>定义Model接口</p>
<pre><code>  public interface IMainModel {
    /**
     * 显示文字逻辑实现
     */
    void show();
}
</code></pre><p>定义结果回调接口，再Presenter中使用，给Model回调，然后再回调view，修改UI</p>
<pre><code>public interface IMainCallback {
    /**
     * 显示结果文字
     * @param string
     */
    void show(String string);
}
</code></pre><p>View实现</p>
<pre><code>public class MainActivity extends Activity implements IMainView {

    private TextView mTextView;
    private Button mButton;
    private IMainPresenter mMainPresenter;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        initView();
        mMainPresenter = new MainPresenter(this);
        mButton.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                mMainPresenter.show();
            }
        });
    }

    void initView() {
        mTextView = (TextView) findViewById(R.id.text);
        mButton = (Button) findViewById(R.id.loadButton);
    }

    @Override
    public void showTextView(final String text) {
        runOnUiThread(new Runnable() {

            @Override
            public void run() {
                mTextView.setText(text);
            }
        });
    }

}
</code></pre><p>Presenter实现</p>
<pre><code>public class MainPresenter implements IMainPresenter,IMainCallback{
    private IMainView mMainView;
    private IMainModel mUserModel;

    public MainPresenter(IMainView view) {
        mMainView = view;
        mUserModel = new MainModel(this);
    }

    @Override
    public void show() {
        mUserModel.show();
    }

    @Override
    public void show(String string) {
        mMainView.showTextView(string);
    }
}
</code></pre><p>Model实现</p>
<pre><code>public class MainModel implements IMainModel {
    IMainCallback call;

    public MainModel(IMainCallback call) {
        this.call = call;
    }

    @Override
    public void show() {
        call.show(&quot;123&quot;);
    }

}    
</code></pre><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><ul>
<li><a href="http://rocko.xyz/2015/11/07/MVVM_Android-CleanArchitecture/" target="_blank" rel="noopener">MVVM_Android-CleanArchitecture</a></li>
<li><a href="http://rocko.xyz/2015/02/06/Android%E4%B8%AD%E7%9A%84MVP/" target="_blank" rel="noopener">Android中的MVP</a></li>
<li><a href="http://toughcoder.net/blog/2015/11/29/understanding-android-mvp-pattern/" target="_blank" rel="noopener">说说Android的MVP模式</a>文章中有些话，摘自<a href="http://toughcoder.net/blog/2015/11/29/understanding-android-mvp-pattern/" target="_blank" rel="noopener">说说Android的MVP模式</a>一文</li>
</ul>
<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p>代码是最好的老师，自行下载:<a href="https://github.com/whiskeyfei/WFAndroidDemo/tree/master/WFAndroid_MVP" target="_blank" rel="noopener">WFAndroid_MVP</a></p>
<h2 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h2><p><a href="http://doraemonyu.me/android/2015/12/17/android-use-mvp2.html" target="_blank" rel="noopener">Android MVP简单使用2</a></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://whiskeyfei.github.io/2015/11/05/android/2015-10-28-android-data-storage/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="無名">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/face.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="無名小子的杂货铺">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/05/android/2015-10-28-android-data-storage/" itemprop="url">Android文件存储那些事 & 工具类整理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-11-05T10:36:02+09:00">2015-11-05</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Android/" itemprop="url" rel="index"><span itemprop="name">Android</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Android中数据存储不外乎以下几种，SharedPreferences、Storage、Sqlite 数据库以及网络；<br>以上几种方式各有各的优点，我们只需要再合适的项目时机选用合适的方式来存储就OK了，不要大材用;</p>
<h2 id="1、Shared-Preferences"><a href="#1、Shared-Preferences" class="headerlink" title="1、Shared Preferences"></a>1、Shared Preferences</h2><p>Android 平台为我们提供了一个 <a href="http://developer.android.com/reference/android/content/SharedPreferences.html" target="_blank" rel="noopener">SharedPreferences</a> 类，它是一个轻量级的存储类，特别适合用于保存软件配置参数。例如:背景设置、第一次启动引导图等；<br>使用 <a href="http://developer.android.com/reference/android/content/SharedPreferences.html" target="_blank" rel="noopener">SharedPreferences</a>  保存数据，其背后是用xml文件存放基本数据结构，key/value的形式，其实就是一个 map 结构，文件存放在/data/data/<package name="">/shared_prefs 目录下。</package></p>
<p>模式</p>
<p>mode为操作模式，默认的模式为0或MODE_PRIVATE，还可以使用MODE_APPEND、MODE_WORLD_READABLE和MODE_WORLD_WRITEABLE。</p>
<h4>commit() 和 apply()区别</h4>

<p><a href="http://developer.android.com/reference/android/content/SharedPreferences.Editor.html#apply(" target="_blank" rel="noopener">commit ()</a>):这个方法是同步的，而且有返回值 true/false，用来标示是否写入成功，以最后一次写入为准。</p>
<pre><code>public abstract boolean commit ()

Added in API level 1
Commit your preferences changes back from this Editor to the SharedPreferences
object it is editing. This atomically performs the requested modifications,
replacing whatever is currently in the SharedPreferences.
Note that when two editors are modifying preferences at the same time,
the last one to call commit wins.If you don&apos;t care about the return value
and you&apos;re using this from your application&apos;s main thread,
consider using apply() instead.
Returns
boolean    Returns true if the new values were successfully written to persistent storage.
</code></pre><p><a href="http://developer.android.com/reference/android/content/SharedPreferences.Editor.html#apply(" target="_blank" rel="noopener">apply ()</a>) :首先没有返回值，是异步操作，先提交内容到内存，然后在异步写入到物理存储，如果内容不是很重要或者不是很关心时可采用 apply ().</p>
<pre><code>public abstract void apply ()

Added in API level 9
Commit your preferences changes back from this Editor to the SharedPreferences object it is editing.
This atomically performs the requested modifications, replacing whatever is currently in the SharedPreferences.
Note that when two editors are modifying preferences at the same time, the last one to call apply wins.
Unlike commit(), which writes its preferences out to persistent storage synchronously, apply() commits its changes to the in-memory SharedPreferences immediately but starts an asynchronous commit to disk and you won&apos;t be notified of any failures. If another editor on this SharedPreferences does a regular commit() while a apply() is still outstanding, the commit() will block until all async commits are completed as well as the commit itself.

As SharedPreferences instances are singletons within a process, it&apos;s safe to replace any instance of commit() with apply() if you were already ignoring the return value.

You don&apos;t need to worry about Android component lifecycles and their interaction with apply() writing to disk. The framework makes sure in-flight disk writes from apply() complete before switching states.

The SharedPreferences.Editor interface isn&apos;t expected to be implemented directly. However, if you previously did implement it and are now getting errors about missing apply(), you can simply call commit() from apply().
</code></pre><p>我们可以查看 SharedPreferences 实现类 SharedPreferencesImpl 的用法，在 apply() 方法实现中，awaitCommit 是一个的 Runnable，就 Runnable<br>添加到了 QueuedWork 中，然后执行 enqueueDiskWrite 方法并写入文件。而 commit() 方法则是一个同步的过程，异常都代表写入失败。</p>
<pre><code>public boolean commit() {
    MemoryCommitResult mcr = commitToMemory();
    SharedPreferencesImpl.this.enqueueDiskWrite(
        mcr, null /* sync write on this thread okay */);
    try {
        mcr.writtenToDiskLatch.await();
    } catch (InterruptedException e) {
        return false;
    }
    notifyListeners(mcr);
    return mcr.writeToDiskResult;
}

public void apply() {
    final MemoryCommitResult mcr = commitToMemory();
    final Runnable awaitCommit = new Runnable() {
            public void run() {
                try {
                    mcr.writtenToDiskLatch.await();
                } catch (InterruptedException ignored) {
                }
            }
        };

    QueuedWork.add(awaitCommit);

    Runnable postWriteRunnable = new Runnable() {
            public void run() {
                awaitCommit.run();
                QueuedWork.remove(awaitCommit);
            }
        };

    SharedPreferencesImpl.this.enqueueDiskWrite(mcr, postWriteRunnable);

    // Okay to notify the listeners before it&apos;s hit disk
    // because the listeners should always get the same
    // SharedPreferences instance back, which has the
    // changes reflected in memory.
    notifyListeners(mcr);
}
</code></pre><p>例子：简单存储两个值</p>
<p>部分代码：</p>
<pre><code>PreferencesUtils.saveString(this,&quot;test&quot;,&quot;key1&quot;,&quot;test1&quot;);
    PreferencesUtils.saveBoolean(this,&quot;test&quot;,&quot;key2&quot;,true);

&lt;?xml version=&apos;1.0&apos; encoding=&apos;utf-8&apos; standalone=&apos;yes&apos; ?&gt;
&lt;map&gt;
    &lt;boolean name=&quot;key2&quot; value=&quot;true&quot; /&gt;
    &lt;string name=&quot;key1&quot;&gt;test1&lt;/string&gt;
&lt;/map&gt;
</code></pre><p>存储在文件地址：</p>
<pre><code>/data/data/com.whiskeyfei.storage/shared_prefs/test.xml
</code></pre><p>工具类1：在 Demo 中抽成一个工具类，以下是部分代码</p>
<pre><code>//写入操作
public static boolean saveFloat(Context context, String name, String key, float value) {
    SharedPreferences settings = context.getSharedPreferences(name, MODE);
    SharedPreferences.Editor editor = settings.edit();
    editor.putFloat(key, value);
    return editor.commit();
}

public static boolean saveString(Context context, String name, String key, String value) {
    SharedPreferences settings = context.getSharedPreferences(name, MODE);
    SharedPreferences.Editor editor = settings.edit();
    editor.putString(key, value);
    return editor.commit();
}

//获取操作
public static String getString(Context context, String name, String key, String defaultValue) {
    SharedPreferences settings = context.getSharedPreferences(name, MODE);
    return settings.getString(key, defaultValue);
}

public static boolean getBoolean(Context context, String name, String key, boolean defaultValue) {
    SharedPreferences settings = context.getSharedPreferences(name, MODE);
    return settings.getBoolean(key, defaultValue);
}
</code></pre><p>工具类2：又写了另外一种方式的工具类，考虑到使用 SharedPreferences 它来完成某一种数据，可能是一个变量也可能是一个数据结构，<br>以下是部分代码.</p>
<pre><code>public class BasePreference {

    private SharedPreferences mSharedPreferences;

    public BasePreference(Context context, String name) {
        if (context != null) {
            mSharedPreferences = context.getSharedPreferences(name,Context.MODE_PRIVATE);
        }
    }

    public void save(String key, String value) {
        if (mSharedPreferences != null) {
            mSharedPreferences.edit().putString(key, value).commit();
        }
    }
}
</code></pre><p>UserPreference 用来实现特定数据操作，名字和字段在 UserPreference 中维护。        </p>
<pre><code>/**
 * 特殊实现，只针对User信息
 */
public class UserPreference {

    private static final String TAG = &quot;UserPreference&quot;;
    private static final String ID = &quot;id&quot;;
    private static final String KEYNAME = &quot;name&quot;;
    private static final String MONEY = &quot;money&quot;;

    private static String NAME = &quot;user_info&quot;;

    public static void saveUser(Context context, User user) {
        BasePreference preference = new BasePreference(context, NAME);
        preference.save(ID, user.getId());
        preference.save(KEYNAME, user.getName());
        preference.save(MONEY, user.getMoney());
    }

    public static User getUser(Context context) {
        User user = new User();
        BasePreference preference = new BasePreference(context, NAME);
        user.setId(preference.getInt(ID, -1));
        user.setName(preference.getString(KEYNAME, &quot;&quot;));
        user.setMoney(preference.getLong(MONEY, -1));
        return user;
    }

}
</code></pre><h2 id="2、保存文件"><a href="#2、保存文件" class="headerlink" title="2、保存文件"></a>2、保存文件</h2><ul>
<li>使用外部存储必须在 manifest 配置读写权限;</li>
<li>存储时检查是否有权限读写、空间是否够用，防止IO异常发生;</li>
<li>事先不知道大小的，可以在出现IO异常时捕获进行处理;</li>
<li>大文件要放到子线程操作;</li>
<li><p>当用户卸载app时，会把内部存储相关的文件都清除干净，而外部存储系统仅仅会删除根目录(getExternalFilesDir())下的相关文件;</p>
<pre><code>//配置权限
 &lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot; /&gt;
 &lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot; /&gt;

//选择目录
getFilesDir()  //  /data/data/package/files/
getCacheDir()
getExternalFilesDir()
getExternalStoragePublicDirectory()
</code></pre></li>
</ul>
<p>注意检查状态</p>
<pre><code>Environment.getExternalStorageState()
Environment.MEDIA_MOUNTED
Environment.MEDIA_MOUNTED_READ_ONLY
</code></pre><h2 id="3、SQL数据库"><a href="#3、SQL数据库" class="headerlink" title="3、SQL数据库"></a>3、SQL数据库</h2><ul>
<li>第三发包使用很方便 <a href="https://github.com/j256/ormlite-android" target="_blank" rel="noopener">ORMLite</a></li>
<li>操作完成后记得关闭数据库链接</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li>简单数据使用 SharedPreferences;</li>
<li>结构化使用 Sqlite 数据库；</li>
<li>重要文件注意要保密;</li>
</ul>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="http://developer.android.com/intl/zh-cn/training/basics/data-storage/shared-preferences.html" target="_blank" rel="noopener">shared-preferences 官方文档</a></li>
<li><a href="http://hukai.me/android-training-course-in-chinese/basics/data-storage/index.html" target="_blank" rel="noopener">数据保存 胡凯翻译官方</a></li>
<li><a href="https://github.com/whiskeyfei/WFAndroidDemo/tree/master/WFDataStorageDemo" target="_blank" rel="noopener">WFDataStorageDemo</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://whiskeyfei.github.io/2015/11/03/android/2015-10-31-android-training-course-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="無名">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/face.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="無名小子的杂货铺">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/03/android/2015-10-31-android-training-course-1/" itemprop="url">Android-Training-Course-Note1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-11-03T16:43:44+09:00">2015-11-03</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Android/" itemprop="url" rel="index"><span itemprop="name">Android</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>从今天起跟着Google官方Android Training课程进行学习，<a href="http://developer.android.com/intl/zh-cn/training/index.html" target="_blank" rel="noopener">官方地址</a>，并且记录在此，也是对以前知识的一个巩固和复习;</p>
<p>参考了<a href="http://hukai.me/" target="_blank" rel="noopener">http://hukai.me/</a>中的 Android-Training-Course 翻译文章，特此感谢;</p>
<p>今天的这篇内容主要有：如何新建 Android 项目、添加 ActionBar、兼容不同的设备、管理 Activity 的生命周期、使用 Fragment建立官方动态的UI、数据保存、与其他应用进行交互等；不会对每个知识点进行详细说明了，记录下可能在开发中需要了解和注意的点就够了，用到的时候 google 下或者查查文档就会了;</p>
<h3 id="1、新建Android项目"><a href="#1、新建Android项目" class="headerlink" title="1、新建Android项目"></a>1、新建Android项目</h3><ul>
<li>了解Android项目结构，清楚配置文件作用，例如：layout、res等;</li>
<li>注意理解配置文件含义、使用命令来编译程序;</li>
<li>使用Android Studio，个人已经渐渐的转到AS了;</li>
<li>尝试自己去布局xml，了解各个标签的使用;</li>
</ul>
<h3 id="2、兼容不同的设备"><a href="#2、兼容不同的设备" class="headerlink" title="2、兼容不同的设备"></a>2、兼容不同的设备</h3><ul>
<li>兼容主要有屏幕大小(layout)、语言(String)、图片(bitmap)、位置(dip,sp)等;</li>
<li>根据不同得区域设置不同得语言目录和字符串文件，<a href="http://my.oschina.net/quttap/blog/204499" target="_blank" rel="noopener">Android各国语言Values文件夹命名规则</a>，随系统切换设置自动读取;</li>
<li>使用dip(控件大小)、sp(文字大小)不推荐使用px;</li>
<li>适配不同的屏幕大小，使用layout-&lt;screen_size&gt;形式，例如:适配大屏幕的layout，layout-large/; 在此文件夹下放置布局文件，需要和其他屏幕的尺寸文件名一样，否则会出错;</li>
<li>根据不同的屏幕分辨率创建不同分辨率的图片资源目录;</li>
<li>注nodpi它可用于您不希望缩放以匹配设备密度的位图资源; .9图片资源,相关目录含义查看<a href="http://developer.android.com/intl/zh-cn/guide/topics/resources/providing-resources.html#AlternativeResources" target="_blank" rel="noopener">官方文档</a>，这里在开发时要用到</li>
<li>兼容低版本,AndroidManifest.xml指定最小和目标API级别，运行时动态去检查系统版本，根据版本高低使用不同平台风格和主题<br>例如:（Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.HONEYCOMB）;</li>
</ul>
<h3 id="3、管理Activity的生命周期"><a href="#3、管理Activity的生命周期" class="headerlink" title="3、管理Activity的生命周期"></a>3、管理Activity的生命周期</h3><ul>
<li>熟悉掌握 Activity 的<a href="http://developer.android.com/training/basics/activity-lifecycle/starting.html" target="_blank" rel="noopener">生命周期图</a>;</li>
<li>必须掌握 Activity 的各个生命周期的使用时机，以及适合处理什么操作:例如：onStop()处理数据 DB 相关等;</li>
<li>生命周期成对出现，例如: onStart() 和 onStop() 初始化和释放一一对应;</li>
<li>UI主线程不要做过多的耗时操作，只用来操作UI现实，耗时操作使用异步去做，各个生命周期都是主线程所以可以操作UI，<br>需要在子线程操作UI的需要使用 Handler 或其他方法 post 到 UI 主线程进行操作;</li>
<li>对使用 Bitmap 的地方进行手动释放 bitmap，避免 OOM、ANR;</li>
<li>谨慎使用 Activity 的 Context 和 this,放置因为有引用无法释放 Activity;</li>
<li>onRestoreInstanceState() 和 onSaveInstanceState()用来恢复之前状态和保存一些系统不能保存得数据，比如：旋转屏幕得时候，生命周期会重新来过，需要保存一些以前状态得数据；使用onRestoreInstanceState()时不用检查Bundle是否null，因为系统仅在数据存在才会调用onRestoreInstanceState()方法;</li>
<li>注意：在onSaveInstanceState()中super.onSaveInstanceState(savedInstanceState)需要在方法得最后一行调用;</li>
</ul>
<h3 id="4、使用Fragment建立动态UI"><a href="#4、使用Fragment建立动态UI" class="headerlink" title="4、使用Fragment建立动态UI"></a>4、使用Fragment建立动态UI</h3><ul>
<li>前提要熟悉 Fragment 的生命周期，并且了解Activity和Fragment生命周期运行时机;</li>
<li>当新建一个Fragment时，必须重写onCreateView()方法来返回view布局，也是为一个需要回调得方法，其余得方法在需要时重写</li>
<li>添加Fragment有xml、代码两种方式添加，在开发中一般都是动态添加、移除、替换等操作;</li>
<li>导入V4包，在Activity中需要调用 getSupportFragmentManager()方法获取FragmentManager 对象，然后调用 beginTransaction() 方法创建一个FragmentTransaction对象，然后调用add()方法添加一个fragment;</li>
<li>通常fragment之间可能会需要交互，比如基于用户事件改变fragment的内容。所有fragment之间的交互需要通过他们关联的activity，两个fragment之间不应该直接交互;</li>
<li>通常都会定义一套固定的接口，实现类来负责几个fragment之间或者和activity之间的数据交互等，开发会很使用，UI也灵活;</li>
</ul>
<h3 id="5、数据保存"><a href="#5、数据保存" class="headerlink" title="5、数据保存"></a>5、数据保存</h3><ul>
<li>三种形式，分别保存到Preferencexml文件、本地文件、数据库，根据自己得需求选择不同得方式来进行数据保存;</li>
<li>Preference:使用最多得为SharedPreferences，可以进行简单得key－value; 键值对形式保存，存储方便适合保存简单数据结构，例如：引导图等;</li>
<li>本地文件:基本上都是读写本地存储文件，本地存储分内部和外部，外部需要读写权限，实际开发中使用过将一个序列化得对象存储在本地，使用时进行反序列化;</li>
<li>Sqlite数据库：相关数据库增删改查，有相应得第三发包使用很方便<a href="https://github.com/j256/ormlite-android" target="_blank" rel="noopener">ORMLite</a></li>
<li>例如:开发中使用存储来实现图片的三级缓存等;</li>
</ul>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ul>
<li>不要在非 UI 线程中初始化 ViewStub，否则会返回 null；</li>
<li>不要通过 Bundle 传递大块的数据，避免 TransactionTooLargeException 异常；</li>
<li>使用时才去创建对象，避免过多使用内存;</li>
</ul>
<h3 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h3><p>关于数据保存更详细介绍，可以查看<a href="!--￼0--">Android文件存储那些事 &amp; 工具类整理</a>,这里做了比较详细的介绍<br>和 Demo 演示</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/uploads/face.jpg"
                alt="無名" />
            
              <p class="site-author-name" itemprop="name">無名</p>
              <p class="site-description motion-element" itemprop="description">记录学习、生活</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">47</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">5</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">31</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/whiskeyfei" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:whiskeyfei@gmail.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.jianshu.com/u/fa272f63280a" target="_blank" title="简书"><i class="fa fa-fw fa-google"></i>简书</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://twitter.com/whiskeyfei" target="_blank" title="Twitter"><i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2014 &mdash; <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">無名</span>

  

  
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Pisces</a> v6.0.5</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.5"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.5"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.0.5"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.0.5"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.5"></script>



  



	





  





  










  





  

  

  

  

  
  

  

  

  

  

</body>
</html>
